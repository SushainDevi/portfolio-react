{
  "version": 3,
  "sources": ["../../@remix-run/cloudflare/dist/crypto.js", "../../@remix-run/cloudflare/dist/implementations.js", "../../@remix-run/cloudflare/dist/sessions/workersKVStorage.js", "../../@remix-run/cloudflare/dist/index.js"],
  "sourcesContent": ["/**\r\n * @remix-run/cloudflare v2.7.1\r\n *\r\n * Copyright (c) Remix Software Inc.\r\n *\r\n * This source code is licensed under the MIT license found in the\r\n * LICENSE.md file in the root directory of this source tree.\r\n *\r\n * @license MIT\r\n */\r\n'use strict';\r\n\r\nObject.defineProperty(exports, '__esModule', { value: true });\r\n\r\nconst encoder = new TextEncoder();\r\nconst sign = async (value, secret) => {\r\n  let key = await createKey(secret, [\"sign\"]);\r\n  let data = encoder.encode(value);\r\n  let signature = await crypto.subtle.sign(\"HMAC\", key, data);\r\n  let hash = btoa(String.fromCharCode(...new Uint8Array(signature))).replace(/=+$/, \"\");\r\n  return value + \".\" + hash;\r\n};\r\nconst unsign = async (signed, secret) => {\r\n  let index = signed.lastIndexOf(\".\");\r\n  let value = signed.slice(0, index);\r\n  let hash = signed.slice(index + 1);\r\n  let key = await createKey(secret, [\"verify\"]);\r\n  let data = encoder.encode(value);\r\n  let signature = byteStringToUint8Array(atob(hash));\r\n  let valid = await crypto.subtle.verify(\"HMAC\", key, signature, data);\r\n  return valid ? value : false;\r\n};\r\nasync function createKey(secret, usages) {\r\n  let key = await crypto.subtle.importKey(\"raw\", encoder.encode(secret), {\r\n    name: \"HMAC\",\r\n    hash: \"SHA-256\"\r\n  }, false, usages);\r\n  return key;\r\n}\r\nfunction byteStringToUint8Array(byteString) {\r\n  let array = new Uint8Array(byteString.length);\r\n  for (let i = 0; i < byteString.length; i++) {\r\n    array[i] = byteString.charCodeAt(i);\r\n  }\r\n  return array;\r\n}\r\n\r\nexports.sign = sign;\r\nexports.unsign = unsign;\r\n", "/**\r\n * @remix-run/cloudflare v2.7.1\r\n *\r\n * Copyright (c) Remix Software Inc.\r\n *\r\n * This source code is licensed under the MIT license found in the\r\n * LICENSE.md file in the root directory of this source tree.\r\n *\r\n * @license MIT\r\n */\r\n'use strict';\r\n\r\nObject.defineProperty(exports, '__esModule', { value: true });\r\n\r\nvar serverRuntime = require('@remix-run/server-runtime');\r\nvar crypto = require('./crypto.js');\r\n\r\nconst createCookie = serverRuntime.createCookieFactory({\r\n  sign: crypto.sign,\r\n  unsign: crypto.unsign\r\n});\r\nconst createCookieSessionStorage = serverRuntime.createCookieSessionStorageFactory(createCookie);\r\nconst createSessionStorage = serverRuntime.createSessionStorageFactory(createCookie);\r\nconst createMemorySessionStorage = serverRuntime.createMemorySessionStorageFactory(createSessionStorage);\r\n\r\nexports.createCookie = createCookie;\r\nexports.createCookieSessionStorage = createCookieSessionStorage;\r\nexports.createMemorySessionStorage = createMemorySessionStorage;\r\nexports.createSessionStorage = createSessionStorage;\r\n", "/**\r\n * @remix-run/cloudflare v2.7.1\r\n *\r\n * Copyright (c) Remix Software Inc.\r\n *\r\n * This source code is licensed under the MIT license found in the\r\n * LICENSE.md file in the root directory of this source tree.\r\n *\r\n * @license MIT\r\n */\r\n'use strict';\r\n\r\nObject.defineProperty(exports, '__esModule', { value: true });\r\n\r\nvar implementations = require('../implementations.js');\r\n\r\n/**\r\n * Creates a SessionStorage that stores session data in the Clouldflare KV Store.\r\n *\r\n * The advantage of using this instead of cookie session storage is that\r\n * KV Store may contain much more data than cookies.\r\n */\r\nfunction createWorkersKVSessionStorage({\r\n  cookie,\r\n  kv\r\n}) {\r\n  return implementations.createSessionStorage({\r\n    cookie,\r\n    async createData(data, expires) {\r\n      while (true) {\r\n        let randomBytes = new Uint8Array(8);\r\n        crypto.getRandomValues(randomBytes);\r\n        // This storage manages an id space of 2^64 ids, which is far greater\r\n        // than the maximum number of files allowed on an NTFS or ext4 volume\r\n        // (2^32). However, the larger id space should help to avoid collisions\r\n        // with existing ids when creating new sessions, which speeds things up.\r\n        let id = [...randomBytes].map(x => x.toString(16).padStart(2, \"0\")).join(\"\");\r\n        if (await kv.get(id, \"json\")) {\r\n          continue;\r\n        }\r\n        await kv.put(id, JSON.stringify(data), {\r\n          expiration: expires ? Math.round(expires.getTime() / 1000) : undefined\r\n        });\r\n        return id;\r\n      }\r\n    },\r\n    async readData(id) {\r\n      let session = await kv.get(id);\r\n      if (!session) {\r\n        return null;\r\n      }\r\n      return JSON.parse(session);\r\n    },\r\n    async updateData(id, data, expires) {\r\n      await kv.put(id, JSON.stringify(data), {\r\n        expiration: expires ? Math.round(expires.getTime() / 1000) : undefined\r\n      });\r\n    },\r\n    async deleteData(id) {\r\n      await kv.delete(id);\r\n    }\r\n  });\r\n}\r\n\r\nexports.createWorkersKVSessionStorage = createWorkersKVSessionStorage;\r\n", "/**\r\n * @remix-run/cloudflare v2.7.1\r\n *\r\n * Copyright (c) Remix Software Inc.\r\n *\r\n * This source code is licensed under the MIT license found in the\r\n * LICENSE.md file in the root directory of this source tree.\r\n *\r\n * @license MIT\r\n */\r\n'use strict';\r\n\r\nObject.defineProperty(exports, '__esModule', { value: true });\r\n\r\nvar workersKVStorage = require('./sessions/workersKVStorage.js');\r\nvar implementations = require('./implementations.js');\r\nvar serverRuntime = require('@remix-run/server-runtime');\r\n\r\n\r\n\r\nexports.createWorkersKVSessionStorage = workersKVStorage.createWorkersKVSessionStorage;\r\nexports.createCookie = implementations.createCookie;\r\nexports.createCookieSessionStorage = implementations.createCookieSessionStorage;\r\nexports.createMemorySessionStorage = implementations.createMemorySessionStorage;\r\nexports.createSessionStorage = implementations.createSessionStorage;\r\nObject.defineProperty(exports, 'MaxPartSizeExceededError', {\r\n  enumerable: true,\r\n  get: function () { return serverRuntime.MaxPartSizeExceededError; }\r\n});\r\nObject.defineProperty(exports, 'broadcastDevReady', {\r\n  enumerable: true,\r\n  get: function () { return serverRuntime.broadcastDevReady; }\r\n});\r\nObject.defineProperty(exports, 'createRequestHandler', {\r\n  enumerable: true,\r\n  get: function () { return serverRuntime.createRequestHandler; }\r\n});\r\nObject.defineProperty(exports, 'createSession', {\r\n  enumerable: true,\r\n  get: function () { return serverRuntime.createSession; }\r\n});\r\nObject.defineProperty(exports, 'defer', {\r\n  enumerable: true,\r\n  get: function () { return serverRuntime.defer; }\r\n});\r\nObject.defineProperty(exports, 'isCookie', {\r\n  enumerable: true,\r\n  get: function () { return serverRuntime.isCookie; }\r\n});\r\nObject.defineProperty(exports, 'isSession', {\r\n  enumerable: true,\r\n  get: function () { return serverRuntime.isSession; }\r\n});\r\nObject.defineProperty(exports, 'json', {\r\n  enumerable: true,\r\n  get: function () { return serverRuntime.json; }\r\n});\r\nObject.defineProperty(exports, 'logDevReady', {\r\n  enumerable: true,\r\n  get: function () { return serverRuntime.logDevReady; }\r\n});\r\nObject.defineProperty(exports, 'redirect', {\r\n  enumerable: true,\r\n  get: function () { return serverRuntime.redirect; }\r\n});\r\nObject.defineProperty(exports, 'redirectDocument', {\r\n  enumerable: true,\r\n  get: function () { return serverRuntime.redirectDocument; }\r\n});\r\nObject.defineProperty(exports, 'unstable_composeUploadHandlers', {\r\n  enumerable: true,\r\n  get: function () { return serverRuntime.unstable_composeUploadHandlers; }\r\n});\r\nObject.defineProperty(exports, 'unstable_createMemoryUploadHandler', {\r\n  enumerable: true,\r\n  get: function () { return serverRuntime.unstable_createMemoryUploadHandler; }\r\n});\r\nObject.defineProperty(exports, 'unstable_parseMultipartFormData', {\r\n  enumerable: true,\r\n  get: function () { return serverRuntime.unstable_parseMultipartFormData; }\r\n});\r\n"],
  "mappings": "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",
  "names": ["crypto"]
}
